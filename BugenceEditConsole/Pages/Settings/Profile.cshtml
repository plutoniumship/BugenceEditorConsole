@page
@model BugenceEditConsole.Pages.Settings.ProfileModel
@{
    ViewData["Title"] = "Profile";
    ViewData["BodyClass"] = "page-settings-profile";

    var userName = Model.DisplayName;
    var userInitials = Model.Initials;
    var displayEmail = string.IsNullOrWhiteSpace(Model.Email) ? "-" : Model.Email;
    var githubUsername = User?.Claims?.FirstOrDefault(c => c.Type == "github:username")?.Value;
    var googleAvatar = User?.Claims?.FirstOrDefault(c => c.Type == "urn:google:avatar")?.Value;

    var workspaceRole = string.IsNullOrWhiteSpace(Model.WorkspaceRole) ? "Viewer" : Model.WorkspaceRole;
    var roleKey = workspaceRole.ToLowerInvariant();
    var roleTitle = roleKey == "admin"
        ? "Company Admin Console"
        : roleKey == "editor"
            ? "Editorial Control Center"
            : "Read-Only Workspace Hub";
    var roleSummary = roleKey == "admin"
        ? "Control security, governance, billing, and team-level policies for your company workspace."
        : roleKey == "editor"
            ? "Tune your production defaults, collaboration rules, and publishing workflow preferences."
            : "Review company configuration, security posture, and activity with read-only access.";
    var canChangeName = Model.CanChangeName;
    var nameChangesRemaining = Model.NameChangesRemaining;

    var capabilityRows = roleKey switch
    {
        "admin" => new[]
        {
            ("Team Administration", "Full Access"),
            ("Security & Policies", "Full Access"),
            ("Billing & Plan", "Full Access"),
            ("Content Operations", "Full Access"),
            ("Audit Logs", "Full Access")
        },
        "editor" => new[]
        {
            ("Team Administration", "No Access"),
            ("Security & Policies", "Limited"),
            ("Billing & Plan", "No Access"),
            ("Content Operations", "Full Access"),
            ("Audit Logs", "Limited")
        },
        _ => new[]
        {
            ("Team Administration", "No Access"),
            ("Security & Policies", "View Only"),
            ("Billing & Plan", "No Access"),
            ("Content Operations", "View Only"),
            ("Audit Logs", "View Only")
        }
    };
}

@section Head {
<style>
        :root {
            --bg: #050608;
            --surface: #0d1117;
            --surface-2: #121820;
            --border: rgba(160, 177, 199, 0.2);
            --text: #ebf1ff;
            --muted: #8fa1ba;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --accent-admin: #22d3ee;
            --accent-editor: #34d399;
            --accent-viewer: #60a5fa;
        }
        * { box-sizing: border-box; outline: none; }
        body { margin: 0; background: radial-gradient(1200px 700px at 85% -10%, rgba(56,189,248,.12), transparent 55%), var(--bg); color: var(--text); font-family: 'Satoshi', sans-serif; display: flex; height: 100vh; overflow: hidden; }
        .shell { display: flex; width: 100%; height: 100%; }
        aside {
            width: 260px;
            flex-shrink: 0;
            background: linear-gradient(180deg, rgba(5,8,14,.98), rgba(5,7,12,.98));
            border-right: 1px solid var(--border);
            padding: 24px;
            display: flex;
            flex-direction: column;
            z-index: 20;
            overflow-y: auto;
        }
        main { flex-grow: 1; overflow-y: auto; padding: 0; }
        .content-container { max-width: 1480px; margin: 0 auto; padding: 34px 30px 44px; }

        .brand { font-family: 'Cabinet Grotesk', sans-serif; font-weight: 800; font-size: 1.2rem; color: white; text-decoration: none; margin-bottom: 36px; display: flex; gap: 10px; align-items: center; }
        .menu-label { font-size: .7rem; color: #5f6b7c; font-weight: 700; margin: 20px 0 8px 12px; text-transform: uppercase; letter-spacing: 1px; }
        .nav-item { padding: 10px 14px; color: var(--muted); text-decoration: none; display: flex; gap: 12px; align-items: center; font-weight: 600; border-radius: 10px; margin-bottom: 4px; transition: .18s; font-size: .9rem; }
        .nav-item:hover { background: rgba(255,255,255,.05); color: #fff; }
        .nav-item.active { border: 1px solid rgba(255,255,255,.14); color: #fff; background: rgba(255,255,255,.05); }
        .nav-icon { width: 20px; text-align: center; }

        .avatar-chip { background: rgba(255,255,255,.06); border: 1px solid var(--border); display: flex; align-items: center; gap: 10px; padding: 8px 12px; border-radius: 12px; color: white; cursor: pointer; transition: .2s; }
        .avatar-chip:hover { background: rgba(255,255,255,.1); }
        .avatar-dot { width: 34px; height: 34px; border-radius: 50%; background: linear-gradient(135deg, #10b981, #22d3ee); color: #05161a; font-weight: 800; display: grid; place-items: center; }
        .avatar-meta { display: flex; flex-direction: column; line-height: 1.2; }
        .dropdown-wrapper { position: relative; }
        .dropdown-menu {
            position: absolute;
            top: 120%;
            right: 0;
            width: 236px;
            background: #101927;
            border: 1px solid var(--border);
            border-radius: 14px;
            box-shadow: 0 20px 38px rgba(0,0,0,.45);
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
            transition: .18s;
            z-index: 100;
            overflow: hidden;
        }
        .dropdown-menu.top-open { top: auto; bottom: 120%; transform: translateY(8px); }
        .dropdown-menu.top-open.show { transform: translateY(0); }
        .dropdown-menu.show { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .profile-option { display: block; margin: 7px; padding: 10px 12px; border-radius: 10px; color: #e2e8f0; text-decoration: none; font-weight: 600; border: 1px solid rgba(255,255,255,.08); background: rgba(255,255,255,.02); }
        .profile-option:hover { border-color: rgba(255,255,255,.24); }

        .hero {
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 20px;
            background: linear-gradient(145deg, rgba(20,27,39,.95), rgba(14,20,31,.95));
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 18px;
            margin-bottom: 18px;
        }
        .hero-title { margin: 0; font-family: 'Cabinet Grotesk', sans-serif; font-size: 2.2rem; letter-spacing: -.02em; }
        .hero-sub { color: var(--muted); margin-top: 8px; margin-bottom: 0; max-width: 760px; }
        .pill-row { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 16px; }
        .pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 999px;
            border: 1px solid var(--border);
            font-size: .78rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: .05em;
            color: #d1d8e6;
            background: rgba(255,255,255,.04);
        }
        .pill.role-admin { border-color: rgba(34,211,238,.45); color: #8cf4ff; background: rgba(34,211,238,.12); }
        .pill.role-editor { border-color: rgba(52,211,153,.45); color: #8af7ca; background: rgba(52,211,153,.12); }
        .pill.role-viewer { border-color: rgba(96,165,250,.45); color: #b9d6ff; background: rgba(96,165,250,.12); }
        .hero-actions { display: flex; flex-direction: column; gap: 10px; justify-content: center; }
        .hero-note { border: 1px dashed rgba(148,163,184,.38); border-radius: 14px; padding: 12px; color: #dbe5f5; font-size: .86rem; background: rgba(255,255,255,.02); }

        .layout { display: grid; grid-template-columns: 1.2fr .8fr; gap: 18px; }
        .stack { display: grid; gap: 18px; }

        .card {
            background: linear-gradient(180deg, rgba(17,23,34,.96), rgba(11,16,24,.96));
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 18px;
            box-shadow: 0 18px 34px rgba(0,0,0,.3);
        }
        .card-title { margin: 0 0 14px; display: flex; align-items: center; justify-content: space-between; gap: 12px; font-size: 1rem; font-weight: 800; }
        .card-title small { color: var(--muted); font-size: .78rem; font-weight: 600; text-transform: uppercase; letter-spacing: .05em; }

        .profile-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 12px; }
        .form-field { display: flex; flex-direction: column; gap: 6px; }
        .form-field label { font-size: .76rem; color: var(--muted); font-weight: 800; letter-spacing: .05em; text-transform: uppercase; }
        .input, .select {
            background: #0a111a;
            border: 1px solid rgba(148,163,184,.26);
            color: #eff6ff;
            border-radius: 12px;
            height: 42px;
            padding: 0 12px;
            font-family: inherit;
            font-size: .92rem;
        }
        .input:focus, .select:focus { border-color: rgba(56,189,248,.8); box-shadow: 0 0 0 3px rgba(56,189,248,.2); }
        .field-error { color: #fb7185; font-size: .75rem; min-height: 16px; }
        .input.error, .select.error { border-color: rgba(248,113,113,.7); box-shadow: 0 0 0 3px rgba(248,113,113,.14); }

        .btn-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 14px; }
        .btn {
            border: 1px solid var(--border);
            background: rgba(255,255,255,.06);
            color: #fff;
            height: 40px;
            border-radius: 12px;
            padding: 0 14px;
            font-weight: 800;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn.primary { border: none; color: #06101a; background: linear-gradient(90deg, #22d3ee, #38bdf8); }
        .btn.primary:hover { filter: brightness(1.08); }
        .btn.warn { border-color: rgba(245,158,11,.35); color: #fcd34d; background: rgba(245,158,11,.1); }
        .btn.danger { border-color: rgba(239,68,68,.35); color: #fecaca; background: rgba(239,68,68,.1); }
        .btn[disabled] { opacity: .55; cursor: not-allowed; }

        .kv-list { display: grid; gap: 10px; }
        .kv-item { padding: 10px 12px; border: 1px solid rgba(148,163,184,.2); border-radius: 12px; background: rgba(255,255,255,.02); display: flex; align-items: center; justify-content: space-between; gap: 10px; }
        .kv-label { font-weight: 700; }
        .kv-sub { color: var(--muted); font-size: .8rem; margin-top: 2px; }

        .access-table { width: 100%; border-collapse: collapse; }
        .access-table th, .access-table td { text-align: left; padding: 10px 8px; border-bottom: 1px solid rgba(148,163,184,.18); }
        .access-table th { font-size: .72rem; letter-spacing: .05em; text-transform: uppercase; color: var(--muted); }
        .access-table td { font-size: .9rem; }
        .access-badge { border-radius: 999px; padding: 4px 10px; font-size: .74rem; font-weight: 800; letter-spacing: .04em; text-transform: uppercase; border: 1px solid rgba(148,163,184,.32); color: #d5e3f6; }
        .access-full { border-color: rgba(34,197,94,.45); color: #86efac; background: rgba(34,197,94,.1); }
        .access-limited { border-color: rgba(245,158,11,.45); color: #fcd34d; background: rgba(245,158,11,.1); }
        .access-viewonly { border-color: rgba(96,165,250,.45); color: #bfdbfe; background: rgba(96,165,250,.1); }
        .access-no { border-color: rgba(239,68,68,.45); color: #fecaca; background: rgba(239,68,68,.1); }

        .role-zone-admin { border-color: rgba(34,211,238,.35); }
        .role-zone-editor { border-color: rgba(52,211,153,.35); }
        .role-zone-viewer { border-color: rgba(96,165,250,.35); }

        .accounts-list { display: grid; gap: 10px; }
        .account-item { padding: 12px; border-radius: 12px; border: 1px solid rgba(148,163,184,.2); background: rgba(255,255,255,.02); display: flex; align-items: center; justify-content: space-between; gap: 10px; }
        .account-meta { display: flex; align-items: center; gap: 10px; }
        .account-icon { width: 34px; height: 34px; border-radius: 10px; background: rgba(255,255,255,.08); display: grid; place-items: center; }
        .account-status { font-size: .8rem; font-weight: 800; }
        .account-status.connected { color: #86efac; }
        .account-status.pending { color: #fcd34d; }

        .toast { position: fixed; right: 20px; bottom: 20px; z-index: 2000; border: 1px solid var(--border); background: #101927; color: #fff; border-radius: 12px; padding: 10px 13px; display: none; box-shadow: 0 16px 30px rgba(0,0,0,.42); }
        .toast.show { display: inline-flex; align-items: center; gap: 8px; }

        @@media (max-width: 1180px) {
            .hero { grid-template-columns: 1fr; }
            .layout { grid-template-columns: 1fr; }
        }
        @@media (max-width: 820px) {
            aside { display: none; }
            .content-container { padding: 18px 12px 30px; }
            .hero-title { font-size: 1.8rem; }
            .profile-grid { grid-template-columns: 1fr; }
        }
    </style>
}

<div class="content-container">

                <section class="hero">
                    <div>
                        <h1 class="hero-title">Advanced Settings</h1>
                        <p class="hero-sub">@roleSummary</p>
                        <div class="pill-row">
                            <span class="pill role-@roleKey"><i class="fa-solid fa-shield-halved"></i> @workspaceRole</span>
                            <span class="pill"><i class="fa-solid fa-circle-check"></i> Workspace Active</span>
                            <span class="pill"><i class="fa-solid fa-building"></i> Company Account</span>
                        </div>
                    </div>
                    <div class="hero-actions">
                        <div class="hero-note">
                            <strong>@roleTitle</strong>
                            <div style="margin-top:6px; color:var(--muted);">This view is tailored to your role in the company workspace. Access levels are enforced server-side.</div>
                        </div>
                        <div class="btn-row" style="margin-top:0;">
                            <a class="btn" href="/Settings/Teams"><i class="fa-solid fa-users"></i> Team Directory</a>
                            <a class="btn" href="/Support/DebugPanel"><i class="fa-solid fa-wave-square"></i> Diagnostics</a>
                        </div>
                    </div>
                </section>

                <section class="layout">
                    <div class="stack">
                        <article class="card">
                            <h2 class="card-title">
                                <span><i class="fa-solid fa-id-card"></i> Identity & Contact</span>
                                <small>Personal Profile</small>
                            </h2>
                            <div class="profile-grid">
                                <div class="form-field">
                                    <label>Full Name</label>
                                    <input class="input" id="accountFullName" value="@userName" data-default="@userName" @(canChangeName ? null : "disabled") />
                                    <span class="field-error" data-error-for="accountFullName">
                                        @(canChangeName ? $"You have {nameChangesRemaining} name change remaining." : "Name can no longer be changed for this account.")
                                    </span>
                                </div>
                                <div class="form-field">
                                    <label>Email</label>
                                    <input class="input" id="accountEmail" value="@Model.Email" data-default="@Model.Email" />
                                    <span class="field-error" data-error-for="accountEmail"></span>
                                </div>
                                <div class="form-field">
                                    <label>Phone</label>
                                    <input class="input" id="accountPhone" value="@Model.PhoneNumber" placeholder="+1 (000) 000-0000" data-default="@Model.PhoneNumber" />
                                    <span class="field-error" data-error-for="accountPhone"></span>
                                </div>
                                <div class="form-field">
                                    <label>Timezone</label>
                                    <select class="select" id="accountTimezone" data-default="@Model.Timezone">
                                        <option value="">Select timezone</option>
                                        <option value="UTC (Default)">UTC (Default)</option>
                                        <option>GMT +4</option>
                                        <option>GMT -5</option>
                                    </select>
                                    <span class="field-error" data-error-for="accountTimezone"></span>
                                </div>
                                <div class="form-field" style="grid-column: span 2;">
                                    <label>Country</label>
                                    <select class="select" id="accountCountry" data-default="@Model.Country">
                                        <option value="">Select a country</option>
                                        <option>United States</option>
                                        <option>Canada</option>
                                        <option>United Kingdom</option>
                                        <option>United Arab Emirates</option>
                                        <option>Germany</option>
                                        <option>France</option>
                                        <option>India</option>
                                        <option>Pakistan</option>
                                        <option>Australia</option>
                                        <option>Japan</option>
                                    </select>
                                    <span class="field-error" data-error-for="accountCountry"></span>
                                </div>
                            </div>
                            <div class="btn-row">
                                <button class="btn primary" id="accountSave"><i class="fa-solid fa-floppy-disk"></i> Save Changes</button>
                                <button class="btn" id="accountReset"><i class="fa-solid fa-rotate-left"></i> Reset</button>
                            </div>
                        </article>

                        <article class="card role-zone-@roleKey">
                            <h2 class="card-title">
                                <span><i class="fa-solid fa-user-lock"></i> Role-Specific Controls</span>
                                <small>@workspaceRole Experience</small>
                            </h2>

                            @if (roleKey == "admin")
                            {
                                <div class="kv-list">
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Organization Governance</div>
                                            <div class="kv-sub">Manage teams, invitations, and permission policies.</div>
                                        </div>
                                        <a class="btn" href="/Settings/Teams">Manage Team</a>
                                    </div>
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Billing & Subscription</div>
                                            <div class="kv-sub">Update payment methods and plan limits.</div>
                                        </div>
                                        <a class="btn" href="/Settings/Billing">Open Billing</a>
                                    </div>
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Workspace Policy</div>
                                            <div class="kv-sub">Control security defaults, domains, and release controls.</div>
                                        </div>
                                        <a class="btn" href="/Settings/GlobalSettings">Global Settings</a>
                                    </div>
                                </div>
                            }
                            else if (roleKey == "editor")
                            {
                                <div class="kv-list">
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Publishing Workflow</div>
                                            <div class="kv-sub">Adjust approval checks, draft behavior, and editor defaults.</div>
                                        </div>
                                        <a class="btn" href="/Workflows/Index">Open Workflows</a>
                                    </div>
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Content Toolchain</div>
                                            <div class="kv-sub">Configure applications, text editor, and template viewers.</div>
                                        </div>
                                        <a class="btn" href="/Tools/Applications">Open Tools</a>
                                    </div>
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Escalation</div>
                                            <div class="kv-sub">Need billing/security changes? Ask an admin.</div>
                                        </div>
                                        <button class="btn warn"><i class="fa-solid fa-paper-plane"></i> Request Admin Action</button>
                                    </div>
                                </div>
                            }
                            else
                            {
                                <div class="kv-list">
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Read-Only Workspace Access</div>
                                            <div class="kv-sub">You can review settings and data without making changes.</div>
                                        </div>
                                        <span class="access-badge access-viewonly">View Only</span>
                                    </div>
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Access Upgrade</div>
                                            <div class="kv-sub">Submit a request if you need editor or admin permissions.</div>
                                        </div>
                                        <button class="btn warn"><i class="fa-solid fa-arrow-up-right-dots"></i> Request Upgrade</button>
                                    </div>
                                    <div class="kv-item">
                                        <div>
                                            <div class="kv-label">Activity Visibility</div>
                                            <div class="kv-sub">Monitor audits, deployment logs, and status indicators.</div>
                                        </div>
                                        <a class="btn" href="/DeployLogs/Index">View Logs</a>
                                    </div>
                                </div>
                            }
                        </article>

                        <article class="card">
                            <h2 class="card-title">
                                <span><i class="fa-solid fa-shield"></i> Access Surface</span>
                                <small>Effective Permissions</small>
                            </h2>
                            <table class="access-table">
                                <thead>
                                    <tr>
                                        <th>Module</th>
                                        <th>Permission</th>
                                    </tr>
                                </thead>
                                <tbody>
                                @foreach (var row in capabilityRows)
                                {
                                    var levelKey = row.Item2.Replace(" ", "", StringComparison.OrdinalIgnoreCase).ToLowerInvariant();
                                    var badgeClass = levelKey switch
                                    {
                                        "fullaccess" => "access-full",
                                        "limited" => "access-limited",
                                        "viewonly" => "access-viewonly",
                                        _ => "access-no"
                                    };
                                    <tr>
                                        <td>@row.Item1</td>
                                        <td><span class="access-badge @badgeClass">@row.Item2</span></td>
                                    </tr>
                                }
                                </tbody>
                            </table>
                        </article>
                    </div>

                    <div class="stack">
                        <article class="card">
                            <h2 class="card-title">
                                <span><i class="fa-solid fa-building"></i> Company Details</span>
                                <small>Read Only</small>
                            </h2>
                            <div class="profile-grid">
                                <div class="form-field">
                                    <label>Company Name</label>
                                    <input class="input" value="@Model.CompanyName" readonly />
                                </div>
                                <div class="form-field">
                                    <label>Phone</label>
                                    <input class="input" value="@Model.CompanyPhoneNumber" readonly />
                                </div>
                                <div class="form-field" style="grid-column: span 2;">
                                    <label>Address Line 1</label>
                                    <input class="input" value="@Model.CompanyAddressLine1" readonly />
                                </div>
                                <div class="form-field" style="grid-column: span 2;">
                                    <label>Address Line 2</label>
                                    <input class="input" value="@Model.CompanyAddressLine2" readonly />
                                </div>
                                <div class="form-field">
                                    <label>City</label>
                                    <input class="input" value="@Model.CompanyCity" readonly />
                                </div>
                                <div class="form-field">
                                    <label>State / Province</label>
                                    <input class="input" value="@Model.CompanyStateOrProvince" readonly />
                                </div>
                                <div class="form-field">
                                    <label>Postal Code</label>
                                    <input class="input" value="@Model.CompanyPostalCode" readonly />
                                </div>
                                <div class="form-field">
                                    <label>Country</label>
                                    <input class="input" value="@Model.CompanyCountry" readonly />
                                </div>
                                <div class="form-field">
                                    <label>Expected Users</label>
                                    <input class="input" value="@(Model.CompanyExpectedUserCount?.ToString() ?? "-")" readonly />
                                </div>
                                <div class="form-field">
                                    <label>Created</label>
                                    <input class="input" value="@(Model.CompanyCreatedAtUtc?.ToLocalTime().ToString("M/d/yyyy h:mm tt") ?? "-")" readonly />
                                </div>
                            </div>
                            <div class="btn-row">
                                <button class="btn" type="button" disabled><i class="fa-solid fa-lock"></i> Company details are locked after account creation</button>
                            </div>
                        </article>

                        <article class="card">
                            <h2 class="card-title">
                                <span><i class="fa-solid fa-key"></i> Security & Session</span>
                                <small>Account Defense</small>
                            </h2>
                            <div class="kv-list">
                                <div class="kv-item">
                                    <div>
                                        <div class="kv-label">Two-Factor Authentication</div>
                                        <div class="kv-sub">Add an extra verification step for sign in.</div>
                                    </div>
                                    <input type="checkbox" @(roleKey == "viewer" ? "disabled" : null) />
                                </div>
                                <div class="kv-item">
                                    <div>
                                        <div class="kv-label">Login Alerts</div>
                                        <div class="kv-sub">Receive alerts for unusual login activity.</div>
                                    </div>
                                    <input type="checkbox" checked />
                                </div>
                            </div>
                            <div class="btn-row">
                                <a class="btn" href="/Settings/ResetPassword"><i class="fa-solid fa-key"></i> Reset Password</a>
                                <button class="btn danger" @(roleKey == "viewer" ? "disabled" : null)><i class="fa-solid fa-user-slash"></i> Deactivate Account</button>
                            </div>
                        </article>

                        <article class="card">
                            <h2 class="card-title">
                                <span><i class="fa-solid fa-plug"></i> Connected Accounts</span>
                                <small>Identity Links</small>
                            </h2>
                            <div class="accounts-list">
                                <div class="account-item">
                                    <div class="account-meta">
                                        <div class="account-icon"><i class="fa-brands fa-github"></i></div>
                                        <div>
                                            <div style="font-weight:700;">GitHub</div>
                                            <div class="kv-sub">@(string.IsNullOrWhiteSpace(githubUsername) ? "Not connected" : $"@{githubUsername}")</div>
                                        </div>
                                    </div>
                                    <div class="account-status @(string.IsNullOrWhiteSpace(githubUsername) ? "pending" : "connected")">
                                        @(string.IsNullOrWhiteSpace(githubUsername) ? "Pending" : "Connected")
                                    </div>
                                </div>
                                <div class="account-item">
                                    <div class="account-meta">
                                        <div class="account-icon"><i class="fa-brands fa-google"></i></div>
                                        <div>
                                            <div style="font-weight:700;">Google</div>
                                            <div class="kv-sub">@(string.IsNullOrWhiteSpace(googleAvatar) ? "Not connected" : "Google account linked")</div>
                                        </div>
                                    </div>
                                    <div class="account-status @(string.IsNullOrWhiteSpace(googleAvatar) ? "pending" : "connected")">
                                        @(string.IsNullOrWhiteSpace(googleAvatar) ? "Pending" : "Connected")
                                    </div>
                                </div>
                            </div>
                            <div class="btn-row">
                                <button class="btn" @(roleKey == "viewer" ? "disabled" : null)><i class="fa-solid fa-link"></i> Manage Connections</button>
                                <button class="btn"><i class="fa-solid fa-clock-rotate-left"></i> Access Logs</button>
                            </div>
                        </article>

                        <article class="card">
                            <h2 class="card-title">
                                <span><i class="fa-solid fa-bell"></i> Smart Notifications</span>
                                <small>Delivery Rules</small>
                            </h2>
                            <div class="kv-list">
                                <div class="kv-item">
                                    <div>
                                        <div class="kv-label">Deployment Alerts</div>
                                        <div class="kv-sub">Immediate notifications for failed or delayed deployments.</div>
                                    </div>
                                    <input type="checkbox" checked />
                                </div>
                                <div class="kv-item">
                                    <div>
                                        <div class="kv-label">Weekly Workspace Briefing</div>
                                        <div class="kv-sub">Summary of edits, logs, and project health.</div>
                                    </div>
                                    <input type="checkbox" />
                                </div>
                                <div class="kv-item">
                                    <div>
                                        <div class="kv-label">Security Incidents</div>
                                        <div class="kv-sub">Critical alerts are always enabled for admins.</div>
                                    </div>
                                    <input type="checkbox" checked @(roleKey == "admin" ? "disabled" : null) />
                                </div>
                            </div>
                        </article>
                    </div>
                </section>
            </div>




