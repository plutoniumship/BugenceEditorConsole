@page
@model BugenceEditConsole.Pages.Settings.GlobalSettingsModel
@{
    ViewData["Title"] = "Global Settings";
    ViewData["BodyClass"] = "page-settings-globalsettings";
    var selectedProject = Model.SelectedProject;
}
@section Head {
<style>
:root{--bg:#020202;--panel:#080808;--panel-2:#0d0d0d;--panel-3:#111111;--line:rgba(255,255,255,.08);--line-strong:rgba(255,255,255,.14);--text:#f3f4f6;--muted:#9ca3af;--muted-2:#6b7280;--accent:#f4f4f5;--accent-soft:rgba(255,255,255,.06);--success:#34d399;--warning:#fbbf24;--danger:#f87171}
.page-settings-globalsettings{background:#020202;color:var(--text)}
.gs-shell{color:var(--text);padding:28px 0 48px}
.gs-hero,.gs-card,.gs-panel-hero,.gs-tab,.gs-item,.gs-int,.gs-stat,.gs-control,.gs-copy{border:1px solid var(--line);background:linear-gradient(180deg,var(--panel-2),var(--panel));box-shadow:none}
.gs-hero{display:flex;justify-content:space-between;gap:24px;padding:28px;border-radius:24px;background:linear-gradient(180deg,#0d0d0d,#070707)}
.gs-kicker,.gs-badge{display:inline-flex;align-items:center;gap:8px;padding:7px 11px;border-radius:999px;font-size:.76rem;font-weight:700}
.gs-kicker{border:1px solid var(--line-strong);background:var(--accent-soft);color:#e5e7eb;text-transform:uppercase;letter-spacing:.14em}
.gs-hero h1,.gs-panel-hero h2,.gs-card h3{font-family:'Cabinet Grotesk','Satoshi',sans-serif;letter-spacing:-.035em}
.gs-hero h1{margin:14px 0 10px;font-size:3rem;line-height:1}
.gs-hero p,.gs-panel-hero p,.gs-soft{margin:0;color:var(--muted);line-height:1.6}
.gs-side{min-width:320px;display:grid;gap:12px}
.gs-control,.gs-copy{padding:16px 18px;border-radius:18px}
.gs-label{display:block;margin-bottom:10px;color:var(--muted-2);font-size:.72rem;font-weight:800;text-transform:uppercase;letter-spacing:.14em}
.gs-select,.gs-code,.gs-btn,.gs-filter{border:1px solid var(--line-strong);border-radius:12px;background:#050505;color:var(--text);font:inherit}
.gs-select{width:100%;padding:14px 16px}
.gs-copyrow,.gs-actions,.gs-pills,.gs-meta,.gs-filters{display:flex;gap:10px;flex-wrap:wrap}
.gs-code{flex:1;padding:12px 14px;font-family:ui-monospace,SFMono-Regular,Menlo,monospace;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:#e5e7eb}
.gs-btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:12px 16px;font-weight:700;text-decoration:none;cursor:pointer;transition:border-color .18s ease,background .18s ease,color .18s ease}
.gs-btn:hover,.gs-filter:hover,.gs-tab:hover{border-color:rgba(255,255,255,.22)}
.gs-btn.primary{background:#f5f5f5;color:#090909;border-color:#f5f5f5}
.gs-btn.secondary{background:#090909;color:var(--text)}
.gs-summary{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:14px;margin:18px 0 22px}
.gs-stat{padding:18px;border-radius:20px}
.gs-stat .v{margin:8px 0 4px;font-size:1.9rem;font-weight:800;letter-spacing:-.035em;color:#fff}
.t-cyan,.t-gold,.t-blue,.t-violet,.t-green{color:#fff}
.gs-layout{display:grid;grid-template-columns:260px minmax(0,1fr);gap:18px}
.gs-tabs{position:sticky;top:18px;display:grid;gap:10px;align-self:start}
.gs-tab{padding:16px 18px;border-radius:18px;color:var(--muted);text-align:left;cursor:pointer;transition:border-color .18s ease,background .18s ease,color .18s ease}
.gs-tab strong{display:flex;align-items:center;gap:10px;color:#e5e7eb;margin-bottom:6px}
.gs-tab span{font-size:.84rem;line-height:1.45}
.gs-tab.active{background:linear-gradient(180deg,#141414,#0d0d0d);border-color:rgba(255,255,255,.18);color:#fff;box-shadow:inset 3px 0 0 #f5f5f5}
.gs-panel{display:none;gap:16px}
.gs-panel.active{display:grid}
.gs-panel-hero,.gs-card{padding:22px;border-radius:22px}
.gs-panel-hero{display:flex;justify-content:space-between;gap:18px;align-items:flex-start;background:linear-gradient(180deg,#101010,#080808)}
.gs-grid2,.gs-grid3,.gs-intgrid{display:grid;gap:16px}
.gs-grid2{grid-template-columns:repeat(2,minmax(0,1fr))}
.gs-grid3{grid-template-columns:repeat(3,minmax(0,1fr))}
.gs-intgrid{grid-template-columns:repeat(2,minmax(0,1fr))}
.gs-meta .box{flex:1 1 180px;padding:16px;border:1px solid var(--line);border-radius:16px;background:#0b0b0b}
.gs-meta .box b{display:block;font-size:1rem;line-height:1.35}
.gs-meta .box small,.gs-mini{color:var(--muted)}
.gs-list{display:grid;gap:12px;margin-top:16px}
.gs-item{display:flex;justify-content:space-between;gap:14px;align-items:flex-start;padding:16px 18px;border-radius:18px;background:#0a0a0a}
.gs-item main{flex:1;min-width:0}
.gs-item strong{display:block;margin-bottom:4px}
.gs-badge{border:1px solid var(--line-strong);background:#0d0d0d;color:#e5e7eb}
.gs-badge.good{color:#d1fae5;border-color:rgba(52,211,153,.24);background:rgba(52,211,153,.08)}
.gs-badge.warn{color:#fef3c7;border-color:rgba(251,191,36,.24);background:rgba(251,191,36,.08)}
.gs-badge.bad{color:#fee2e2;border-color:rgba(248,113,113,.24);background:rgba(248,113,113,.08)}
.gs-progress{height:10px;border-radius:999px;background:#050505;overflow:hidden;border:1px solid var(--line)}
.gs-progress>span{display:block;height:100%;border-radius:999px;background:linear-gradient(90deg,#737373,#f5f5f5)}
.gs-int{padding:18px;border-radius:20px;display:grid;gap:14px;background:#0a0a0a}
.gs-inthead{display:flex;justify-content:space-between;gap:14px}
.gs-inttitle{display:flex;gap:14px;align-items:center}
.gs-inticon{width:46px;height:46px;border-radius:14px;display:grid;place-items:center;font-size:1.1rem;color:#fff;box-shadow:inset 0 0 0 1px rgba(255,255,255,.08)}
.gs-filter{padding:10px 14px;font-size:.82rem;font-weight:700;color:var(--muted);cursor:pointer}
.gs-filter.active{color:#fff;border-color:rgba(255,255,255,.2);background:#111111}
.gs-empty{padding:10px 0;color:var(--muted)}
.sev-success{color:#d1fae5}
.sev-warning{color:#fef3c7}
.sev-accent{color:#e5e7eb}
.sev-neutral{color:#dbe4ef}
@@media(max-width:1400px){.gs-summary{grid-template-columns:repeat(3,minmax(0,1fr))}.gs-grid3,.gs-intgrid{grid-template-columns:repeat(2,minmax(0,1fr))}}
@@media(max-width:1100px){.gs-hero,.gs-layout,.gs-panel-hero{display:grid;grid-template-columns:1fr}.gs-summary,.gs-grid2,.gs-grid3,.gs-intgrid{grid-template-columns:1fr}.gs-tabs{position:static;grid-template-columns:repeat(2,minmax(0,1fr))}.gs-side{min-width:0}}
</style>
}
<div class="gs-shell">
<section class="gs-hero"><div><div class="gs-kicker"><i class="fa-solid fa-wave-square"></i> Workspace command center</div><h1>Global Settings</h1><p>Each tab now uses actual workspace data for <strong>@Model.Workspace.Name</strong> and is structured to expand into deeper controls later.</p></div><div class="gs-side"><form method="get" class="gs-control" id="gsProjectForm"><label class="gs-label" for="projectSelect">Project context</label><select class="gs-select" name="projectId" id="projectSelect"><option value="">Latest activity</option>@foreach (var project in Model.Projects){if (selectedProject?.Id == project.Id){<option value="@project.Id" selected>@project.Name</option>} else {<option value="@project.Id">@project.Name</option>}}</select></form><div class="gs-copy"><label class="gs-label">Workspace key</label><div class="gs-copyrow"><div class="gs-code" id="workspaceKey">@Model.Workspace.WorkspaceKey</div><button class="gs-btn secondary" type="button" data-copy="#workspaceKey">Copy</button></div></div></div></section>
<section class="gs-summary"><article class="gs-stat"><div class="gs-label">Projects</div><div class="v t-cyan">@Model.Workspace.ProjectCount</div><div class="gs-mini">@Model.Workspace.PublishedProjectCount published</div></article><article class="gs-stat"><div class="gs-label">Team</div><div class="v t-gold">@Model.Workspace.TeamCount</div><div class="gs-mini">@Model.Workspace.PendingInviteCount pending invites</div></article><article class="gs-stat"><div class="gs-label">Domains</div><div class="v t-blue">@Model.Workspace.DomainCount</div><div class="gs-mini">Delivery surfaces</div></article><article class="gs-stat"><div class="gs-label">Traffic 7D</div><div class="v t-violet">@Model.Workspace.PageViews7d</div><div class="gs-mini">@Model.Workspace.Events7d tracked events</div></article><article class="gs-stat"><div class="gs-label">Storage</div><div class="v t-green">@Model.Workspace.StorageUsedLabel</div><div class="gs-mini">@Model.Workspace.ConnectedProviderCount integrations</div></article></section>
<section class="gs-layout"><aside class="gs-tabs">
<button class="gs-tab active" type="button" data-tab="general"><strong><i class="fa-solid fa-compass"></i> General</strong><span>Identity, scope, and workspace footprint.</span></button>
<button class="gs-tab" type="button" data-tab="billing"><strong><i class="fa-solid fa-credit-card"></i> Billing & Plans</strong><span>Plan status, storage, and payment posture.</span></button>
<button class="gs-tab" type="button" data-tab="api"><strong><i class="fa-solid fa-key"></i> API Access</strong><span>Live access surface and future token layer.</span></button>
<button class="gs-tab" type="button" data-tab="webhooks"><strong><i class="fa-solid fa-bolt"></i> Webhooks</strong><span>Triggers, deliveries, and automation reliability.</span></button>
<button class="gs-tab" type="button" data-tab="notifications"><strong><i class="fa-regular fa-bell"></i> Notifications</strong><span>Inbox state and recent alerts.</span></button>
<button class="gs-tab" type="button" data-tab="security"><strong><i class="fa-solid fa-shield-halved"></i> Security & SSO</strong><span>Auth posture and access readiness.</span></button>
<button class="gs-tab" type="button" data-tab="integrations"><strong><i class="fa-solid fa-plug-circle-bolt"></i> Integrations</strong><span>Connected providers and planned slots.</span></button>
<button class="gs-tab" type="button" data-tab="audit"><strong><i class="fa-solid fa-clock-rotate-left"></i> Audit Logs</strong><span>Unified activity stream.</span></button>
</aside><div class="gs-panels">
<section class="gs-panel active" data-panel="general"><div class="gs-panel-hero"><div><h2>Workspace identity and operating context</h2><p>Real workspace metadata, management scope, and project signals in one place.</p></div><div class="gs-pills"><span class="gs-badge @(Model.Workspace.CanManageWorkspace ? "good" : "warn")">@Model.Workspace.ScopeLabel</span><span class="gs-badge">Owner: @Model.Workspace.OwnerName</span></div></div><div class="gs-grid2"><article class="gs-card"><h3>Workspace profile</h3><div class="gs-meta"><div class="box"><small class="gs-label">Workspace</small><b>@Model.Workspace.Name</b><small>@Model.Workspace.Subtitle</small></div><div class="box"><small class="gs-label">Owner email</small><b>@Model.Workspace.OwnerEmail</b><small>Primary account authority</small></div><div class="box"><small class="gs-label">Location</small><b>@Model.Workspace.Location</b><small>Company profile footprint</small></div><div class="box"><small class="gs-label">Scope</small><b>@Model.Workspace.ScopeLabel</b><small>Workspace visibility model</small></div></div></article><article class="gs-card"><h3>Selected project spotlight</h3>@if (selectedProject is null){<p class="gs-empty">No uploaded project exists yet for this workspace.</p>} else {<div class="gs-pills" style="margin-bottom:14px;"><span class="gs-badge good">@selectedProject.EnvironmentLabel</span><span class="gs-badge">@selectedProject.Status</span><span class="gs-badge">@selectedProject.SizeLabel</span></div><div class="gs-meta"><div class="box"><small class="gs-label">Project</small><b>@selectedProject.Name</b><small>/@selectedProject.Slug</small></div><div class="box"><small class="gs-label">Files</small><b>@selectedProject.FileCount</b><small>Tracked uploaded files</small></div><div class="box"><small class="gs-label">Domains</small><b>@selectedProject.DomainCount</b><small>Attached domain entries</small></div><div class="box"><small class="gs-label">Preflight</small><b>@(selectedProject.PreflightScore?.ToString() ?? "No run")</b><small>@(selectedProject.PreflightSafe == true ? "Safe" : selectedProject.PreflightSafe == false ? "Needs review" : "No recent signal")</small></div></div><p class="gs-soft" style="margin-top:14px;">@selectedProject.ActivityLabel</p>}</article></div><article class="gs-card"><h3>Workspace projects</h3><p class="gs-soft">Current uploaded project records with their real delivery signals.</p><div class="gs-list">@if (Model.Projects.Count == 0){<p class="gs-empty">No projects found for this workspace.</p>} else {@foreach (var project in Model.Projects.Take(6)){<article class="gs-item"><main><strong>@project.Name</strong><div class="gs-mini">/@project.Slug • @project.ActivityLabel</div></main><div class="gs-pills"><span class="gs-badge">@project.EnvironmentLabel</span><span class="gs-badge">@project.FileCount files</span><span class="gs-badge">@project.DomainCount domains</span></div></article>}}</div></article></section>
<section class="gs-panel" data-panel="billing"><div class="gs-panel-hero"><div><h2>Billing, plan posture, and storage</h2><p>Built from the actual subscription record and saved payment methods on the workspace owner account.</p></div><div class="gs-actions"><a class="gs-btn primary" href="/Settings/Billing">Open billing</a></div></div><div class="gs-grid2"><article class="gs-card"><h3>@Model.Billing.PlanName plan</h3><div class="gs-pills" style="margin-bottom:14px;"><span class="gs-badge good">@Model.Billing.Status</span><span class="gs-badge">@Model.Billing.IntervalLabel</span><span class="gs-badge">@Model.Billing.Provider</span></div><div class="gs-meta"><div class="box"><small class="gs-label">Estimated charge</small><b>@Model.Billing.EstimatedChargeLabel</b><small>Plan pricing posture</small></div><div class="box"><small class="gs-label">Renewal</small><b>@Model.Billing.RenewalLabel</b><small>Next billing checkpoint</small></div></div><div style="margin-top:18px;" class="gs-label">Storage usage</div><div class="gs-progress"><span style="width:@Model.Billing.UsagePercent%;"></span></div><div class="gs-pills" style="margin-top:12px;"><span class="gs-badge">@Model.Billing.StorageUsedLabel used</span><span class="gs-badge">@Model.Billing.StorageLimitLabel included</span></div></article><article class="gs-card"><h3>Payment methods</h3><div class="gs-list">@if (Model.Billing.PaymentMethods.Count == 0){<p class="gs-empty">No payment method is stored yet.</p>} else {@foreach (var method in Model.Billing.PaymentMethods){<article class="gs-item"><main><strong>@method.Brand ending in @method.Last4</strong><div class="gs-mini">Expires @method.Expiry • Added @method.AddedAtLabel</div></main><div class="gs-pills">@if (method.IsDefault){<span class="gs-badge good">Default</span>}<span class="gs-badge">@method.Provider</span></div></article>}}</div></article></div><article class="gs-card"><h3>Billing alerts</h3><div class="gs-list">@if (Model.Billing.Alerts.Count == 0){<p class="gs-empty">No billing alerts are active right now.</p>} else {@foreach (var alert in Model.Billing.Alerts){<div class="gs-badge warn">@alert</div>}}</div></article></section>
<section class="gs-panel" data-panel="api"><div class="gs-panel-hero"><div><h2>API access surface and token-ready foundation</h2><p>Live workspace origin, automation surface, telemetry counts, and an explicit future token registry placeholder.</p></div><div class="gs-actions"><button class="gs-btn secondary" type="button" data-copy-value="@Model.ApiAccess.BaseOrigin">Copy origin</button></div></div><div class="gs-grid3"><article class="gs-card"><h3>@Model.ApiAccess.PageViews7d</h3><p class="gs-soft">Page views in the last 7 days.</p></article><article class="gs-card"><h3>@Model.ApiAccess.Events7d</h3><p class="gs-soft">Tracked events in the same window.</p></article><article class="gs-card"><h3>@Model.ApiAccess.WorkflowCount</h3><p class="gs-soft">Workflow automations with @Model.ApiAccess.TriggerCount configured triggers.</p></article></div><article class="gs-card"><h3>Access surfaces</h3><div class="gs-list">@foreach (var surface in Model.ApiAccess.Surfaces){<article class="gs-item"><main><strong>@surface.Name</strong><div class="gs-mini">@surface.Summary</div></main><div class="gs-pills"><span class="gs-badge">@surface.Value</span><span class="gs-badge good">@surface.Status</span></div></article>}</div></article></section>
<section class="gs-panel" data-panel="webhooks"><div class="gs-panel-hero"><div><h2>Webhook and automation delivery</h2><p>Real trigger configuration rows and recent event log outcomes now feed this tab instead of hardcoded deliveries.</p></div><div class="gs-pills"><span class="gs-badge">@Model.Webhooks.ConfiguredSourceCount sources</span><span class="gs-badge @(Model.Webhooks.SuccessRate >= 80 ? "good" : "warn")">@Model.Webhooks.SuccessRate% success</span></div></div><div class="gs-grid2"><article class="gs-card"><h3>Configured sources</h3><div class="gs-list">@if (Model.Webhooks.Sources.Count == 0){<p class="gs-empty">No trigger sources are configured yet.</p>} else {@foreach (var source in Model.Webhooks.Sources){<article class="gs-item"><main><strong>@source.WorkflowName</strong><div class="gs-mini">@source.TriggerType • @source.EventName • @source.UpdatedAtLabel</div></main><span class="gs-badge">@source.Mode</span></article>}}</div></article><article class="gs-card"><h3>Recent deliveries</h3><div class="gs-list">@if (Model.Webhooks.Deliveries.Count == 0){<p class="gs-empty">No delivery logs have been recorded yet.</p>} else {@foreach (var delivery in Model.Webhooks.Deliveries){var deliveryClass = string.Equals(delivery.Outcome, "processed", StringComparison.OrdinalIgnoreCase) ? "good" : "warn";<article class="gs-item"><main><strong>@delivery.WorkflowName</strong><div class="gs-mini">@delivery.Provider • @delivery.Mode • @delivery.ProcessedAtLabel</div></main><span class="gs-badge @deliveryClass">@delivery.Outcome</span></article>}}</div></article></div></section>
<section class="gs-panel" data-panel="notifications"><div class="gs-panel-hero"><div><h2>Notification center posture</h2><p>The counts and recent items below are pulled from the real notification inbox for the signed-in user.</p></div><div class="gs-actions"><a class="gs-btn secondary" href="/Support/Notifications">Open inbox</a></div></div><div class="gs-pills"><span class="gs-badge good">@Model.Notifications.UnreadCount unread</span><span class="gs-badge">@Model.Notifications.TotalCount total</span><span class="gs-badge">@Model.Notifications.InfoCount info</span><span class="gs-badge">@Model.Notifications.SuccessCount success</span><span class="gs-badge">@Model.Notifications.WarningCount warning</span><span class="gs-badge bad">@Model.Notifications.ErrorCount error</span></div><article class="gs-card"><h3>Recent notifications</h3><div class="gs-list">@if (Model.Notifications.Recent.Count == 0){<p class="gs-empty">No notifications are available for this user yet.</p>} else {@foreach (var item in Model.Notifications.Recent){var typeClass = (item.Type ?? string.Empty).ToLowerInvariant() switch { "success" => "good", "warning" => "warn", "error" => "bad", _ => string.Empty };<article class="gs-item"><main><strong>@item.Title</strong><div class="gs-mini">@item.Message</div></main><div class="gs-pills"><span class="gs-badge @typeClass">@item.Type</span><span class="gs-badge">@item.TimeLabel</span>@if (!item.IsRead){<span class="gs-badge good">Unread</span>}</div></article>}}</div></article></section>
<section class="gs-panel" data-panel="security"><div class="gs-panel-hero"><div><h2>Security, recovery, and SSO foundation</h2><p>This tab is now driven by the actual identity state of the workspace owner instead of static toggles.</p></div><div class="gs-actions"><a class="gs-btn secondary" href="/Settings/ResetPassword">Reset password</a><a class="gs-btn secondary" href="/Settings/Teams">Manage team</a></div></div><div class="gs-grid3"><article class="gs-card"><h3>@(Model.Security.EmailConfirmed ? "Verified" : "Unverified")</h3><p class="gs-soft">Recovery email status for the workspace owner account.</p></article><article class="gs-card"><h3>@(Model.Security.TwoFactorEnabled ? "Enabled" : "Disabled")</h3><p class="gs-soft">Two-factor authentication state.</p></article><article class="gs-card"><h3>@Model.Security.ExternalLoginCount</h3><p class="gs-soft">External login providers attached to the owner account.</p></article></div><div class="gs-grid2"><article class="gs-card"><h3>Workspace access posture</h3><div class="gs-meta"><div class="box"><small class="gs-label">Admins</small><b>@Model.Security.AdminCount</b><small>Can manage workspace scope</small></div><div class="box"><small class="gs-label">Active members</small><b>@Model.Security.ActiveMemberCount</b><small>Current team footprint</small></div><div class="box"><small class="gs-label">Pending invites</small><b>@Model.Security.PendingInviteCount</b><small>Access not yet accepted</small></div><div class="box"><small class="gs-label">SSO</small><b>@Model.Security.SsoStatus</b><small>Enterprise identity expansion point</small></div></div></article><article class="gs-card"><h3>Recovery activity</h3><div class="gs-meta"><div class="box"><small class="gs-label">Password resets (30D)</small><b>@Model.Security.PasswordResetRequests30d</b><small>Recent recovery attempts</small></div><div class="box"><small class="gs-label">OTP requests (7D)</small><b>@Model.Security.OtpRequests7d</b><small>Recent email code generation</small></div><div class="box"><small class="gs-label">Phone</small><b>@(Model.Security.PhoneConfigured ? "Configured" : "Not configured")</b><small>Secondary identity channel</small></div><div class="box"><small class="gs-label">Recovery note</small><b>@Model.Security.RecoveryStatus</b><small>Current account readiness</small></div></div></article></div></section>
<section class="gs-panel" data-panel="integrations"><div class="gs-panel-hero"><div><h2>External providers and expansion slots</h2><p>Connected providers are live. Planned slots remain visible so this tab can scale without redesigning its base structure later.</p></div><div class="gs-pills"><span class="gs-badge good">@Model.Integrations.ConnectedCount connected</span><span class="gs-badge">@Model.Integrations.Cards.Count total cards</span></div></div><div class="gs-intgrid">@foreach (var card in Model.Integrations.Cards){<article class="gs-int"><div class="gs-inthead"><div class="gs-inttitle"><div class="gs-inticon" style="background:@card.Accent;"><i class="@card.IconClass"></i></div><div><strong>@card.Name</strong><div class="gs-mini">@card.Summary</div></div></div><span class="gs-badge @(card.IsConnected ? "good" : "warn")">@card.Status</span></div><p class="gs-soft">@card.StatusMeta</p><a class="gs-btn secondary" href="@card.ActionUrl">@card.ActionLabel</a></article>}</div></section>
<section class="gs-panel" data-panel="audit"><div class="gs-panel-hero"><div><h2>Unified activity log</h2><p>This stream consolidates Dynamic VE entries, workflow runs, invites, project events, and notifications into one expandable audit foundation.</p></div><div class="gs-pills"><span class="gs-badge">@Model.Audit.TotalCount records</span><span class="gs-badge">@Model.Audit.DynamicVeCount dynamic VE</span><span class="gs-badge">@Model.Audit.WorkflowCount workflow</span></div></div><div class="gs-filters"><button class="gs-filter active" type="button" data-audit-filter="all">All</button><button class="gs-filter" type="button" data-audit-filter="dynamicve">Dynamic VE</button><button class="gs-filter" type="button" data-audit-filter="workflow">Workflow</button><button class="gs-filter" type="button" data-audit-filter="team">Team</button><button class="gs-filter" type="button" data-audit-filter="project">Project</button><button class="gs-filter" type="button" data-audit-filter="notification">Notification</button></div><article class="gs-card"><h3>Recent audit stream</h3><div class="gs-list">@if (Model.Audit.Items.Count == 0){<p class="gs-empty">No audit items are available yet.</p>} else {@foreach (var item in Model.Audit.Items){var severityClass = item.Severity switch { "success" => "sev-success", "warning" => "sev-warning", "accent" => "sev-accent", _ => "sev-neutral" };<article class="gs-item" data-audit-item="@item.Category"><main><strong class="@severityClass">@item.Title</strong><div class="gs-mini">@item.Target • @item.Meta</div></main><div class="gs-pills"><span class="gs-badge">@item.Category</span><span class="gs-badge">@item.TimeUtc.ToLocalTime().ToString("MMM d, yyyy h:mm tt")</span></div></article>}}</div></article></section>
</div></section></div>
<script>
(() => {
 const tabs=[...document.querySelectorAll('[data-tab]')],panels=[...document.querySelectorAll('[data-panel]')];
 const activate=(tab)=>{const t=tab||'general';tabs.forEach(b=>b.classList.toggle('active',b.dataset.tab===t));panels.forEach(p=>p.classList.toggle('active',p.dataset.panel===t));if(location.hash!==`#${t}`)history.replaceState(null,'',`#${t}`)};
 tabs.forEach(b=>b.addEventListener('click',()=>activate(b.dataset.tab)));activate((location.hash||'#general').replace('#',''));
 document.getElementById('projectSelect')?.addEventListener('change',()=>document.getElementById('gsProjectForm')?.submit());
 const copy=async(v)=>{try{await navigator.clipboard.writeText(v);window.showToast&&window.showToast('Copied to clipboard.','success')}catch{window.showToast&&window.showToast('Unable to copy value.','warning')}};
 document.querySelectorAll('[data-copy]').forEach(b=>b.addEventListener('click',()=>{const target=document.querySelector(b.getAttribute('data-copy')); if(target) copy(target.textContent||'');}));
 document.querySelectorAll('[data-copy-value]').forEach(b=>b.addEventListener('click',()=>copy(b.getAttribute('data-copy-value')||'')));
 const filters=[...document.querySelectorAll('[data-audit-filter]')],items=[...document.querySelectorAll('[data-audit-item]')];
 filters.forEach(b=>b.addEventListener('click',()=>{const f=b.getAttribute('data-audit-filter')||'all';filters.forEach(x=>x.classList.toggle('active',x===b));items.forEach(row=>row.style.display=f==='all'||row.getAttribute('data-audit-item')===f?'':'none');}));
})();
</script>
