@page
@model BugenceEditConsole.Pages.Auth.LoginModel
@{
    Layout = null;
    var returnUrl = Model.ReturnUrl ?? Url.Content("~/Dashboard/Index");
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bugence</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --bg: #000000;
            --accent: #ff4d00;
            --evolution-1: #00d2ff;
            --evolution-2: #ff00f2;
        }

        body { background-color: var(--bg); color: #fff; font-family: 'Space Mono', monospace; overflow: hidden; cursor: none; }
        .evolution-form { position: absolute; left: 10%; top: 50%; transform: translateY(-50%); z-index: 200; width: 420px; }
        .step-indicator { font-size: 10px; color: var(--accent); letter-spacing: 5px; margin-bottom: 10px; display: block; transition: 0.5s; }
        .brand-mark { display: flex; align-items: center; gap: 12px; }
        .brand-logo { width: 56px; height: auto; display: block; filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.12)); }
        #morphText { font-family: 'Space Mono', monospace; font-size: 14px; letter-spacing: 0.08em; line-height: 1.2; display: inline-block; text-transform: uppercase; color: #ffffff; }
        .evo-input { background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.05); padding: 20px; width: 100%; margin-bottom: 1.5rem; color: white; outline: none; transition: 0.5s cubic-bezier(0.19, 1, 0.22, 1); border-radius: 4px; }
        .evo-input:focus { background: rgba(255,255,255,0.05); border-color: var(--accent); box-shadow: 0 0 30px rgba(255,77,0,0.1); }
        .primary-login { width: 100%; padding: 1.25rem 0; background: #fff; color: #000; font-weight: 700; font-size: 0.875rem; letter-spacing: 0.5em; text-transform: uppercase; transition: all 0.5s; border: 0; border-radius: 4px; }
        .primary-login:hover { background: var(--accent); color: #fff; }
        .social-divider { display: flex; align-items: center; gap: 12px; margin: 14px 0 10px; color: rgba(255,255,255,0.6); font-size: 10px; letter-spacing: 0.28em; text-transform: uppercase; }
        .social-divider::before, .social-divider::after { content: ""; height: 1px; background: linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.2), rgba(255,255,255,0.03)); flex: 1; }
        .social-login-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .social-btn { border: 1px solid rgba(255,255,255,0.15); background: rgba(255,255,255,0.02); color: #fff; min-height: 54px; border-radius: 6px; display: inline-flex; align-items: center; justify-content: center; gap: 10px; font-size: 11px; letter-spacing: 0.2em; text-transform: uppercase; transition: 0.35s cubic-bezier(0.19, 1, 0.22, 1); width: 100%; }
        .social-btn svg { width: 16px; height: 16px; flex-shrink: 0; }
        .social-btn:hover { transform: translateY(-2px); border-color: rgba(255,255,255,0.4); box-shadow: 0 8px 24px rgba(0,0,0,0.35); }
        .social-btn.google:hover { box-shadow: 0 8px 24px rgba(234, 67, 53, 0.28); border-color: rgba(234, 67, 53, 0.55); background: rgba(234, 67, 53, 0.08); }
        .social-btn.github:hover { box-shadow: 0 8px 24px rgba(111, 66, 193, 0.28); border-color: rgba(111, 66, 193, 0.55); background: rgba(111, 66, 193, 0.08); }
        .account-cta { margin-top: 14px; border: 1px solid rgba(255,255,255,0.12); border-radius: 8px; padding: 12px; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); display: flex; align-items: center; justify-content: space-between; gap: 12px; }
        .account-copy { font-size: 10px; letter-spacing: 0.2em; text-transform: uppercase; color: rgba(255,255,255,0.68); line-height: 1.5; }
        .signup-btn { border: 1px solid rgba(255, 77, 0, 0.55); background: rgba(255, 77, 0, 0.14); color: #fff; min-height: 42px; padding: 0 18px; border-radius: 6px; font-size: 11px; letter-spacing: 0.26em; text-transform: uppercase; transition: 0.35s cubic-bezier(0.19, 1, 0.22, 1); white-space: nowrap; display: inline-flex; align-items: center; justify-content: center; text-decoration: none; }
        .signup-btn:hover { transform: translateY(-2px); background: rgba(255, 77, 0, 0.9); border-color: rgba(255, 77, 0, 1); box-shadow: 0 10px 24px rgba(255, 77, 0, 0.32); }
        .forgot-link { display: inline-block; margin-top: 10px; color: rgba(255,255,255,0.8); font-size: 11px; text-decoration: none; letter-spacing: 0.12em; text-transform: uppercase; }
        .forgot-link:hover { color: #fff; text-decoration: underline; }
        .validation-wrap { margin: 0 0 12px 0; }
        .validation, .field-validation-error { color: #ff8260; font-size: 12px; line-height: 1.4; }
        .status-bracket { position: fixed; border: 1px solid rgba(255,255,255,0.1); width: 100px; height: 100px; pointer-events: none; }
        .top-l { top: 40px; left: 40px; border-right: none; border-bottom: none; }
        .bot-r { bottom: 40px; right: 40px; border-left: none; border-top: none; }
        #canvas-container { position: fixed; inset: 0; z-index: 1; }
        #cursor { position: fixed; width: 6px; height: 6px; background: white; border-radius: 50%; pointer-events: none; z-index: 10000; mix-blend-mode: difference; }
    </style>
</head>
<body>
    <div id="cursor"></div>
    <div id="canvas-container"></div>
    <div class="status-bracket top-l"></div>
    <div class="status-bracket bot-r"></div>

    <main class="evolution-form">
        <header class="mb-12">
            <span class="step-indicator" id="phaseText">Enter your username and password to proceed</span>
            <div class="brand-mark">
                <img src="/images/bugence-logo.svg" alt="Bugence logo" class="brand-logo">
                <span id="morphText">Bugence powered by Biz Bridge Connect</span>
            </div>
        </header>

        @if (!string.IsNullOrWhiteSpace(Model.ExternalLoginError))
        {
            <div class="validation-wrap">
                <div class="validation" role="alert">@Model.ExternalLoginError</div>
            </div>
        }

        <form method="post" id="loginForm">
            <input type="hidden" name="returnUrl" value="@returnUrl" />
            <div asp-validation-summary="ModelOnly" class="validation validation-wrap" role="alert"></div>
            <div>
                <input asp-for="Input.Email" type="email" class="evo-input" placeholder="Email" id="idField" autocomplete="email">
                <span asp-validation-for="Input.Email" class="field-validation-error"></span>
            </div>
            <div>
                <input asp-for="Input.Password" type="password" class="evo-input" placeholder="Password" id="passField" autocomplete="current-password">
                <span asp-validation-for="Input.Password" class="field-validation-error"></span>
            </div>
            <button class="primary-login" type="submit">LOGIN</button>
        </form>

        <a href="/Auth/ForgotPassword" class="forgot-link">Forgot Password?</a>

        <div class="social-divider">or continue with</div>
        <div class="social-login-grid">
            <form method="post" asp-page-handler="ExternalLogin">
                <input type="hidden" name="provider" value="Google" />
                <input type="hidden" name="returnUrl" value="@returnUrl" />
                <button class="social-btn google" type="submit">
                    <svg viewBox="0 0 24 24" aria-hidden="true">
                        <path fill="#EA4335" d="M12 10.2v4.1h5.8c-.3 1.5-1.8 4.3-5.8 4.3-3.5 0-6.3-2.9-6.3-6.6s2.8-6.6 6.3-6.6c2 0 3.3.8 4 1.6l2.7-2.6C17 2.8 14.8 2 12 2 6.9 2 2.8 6.2 2.8 12s4.1 10 9.2 10c5.3 0 8.9-3.7 8.9-8.9 0-.6-.1-1.1-.2-1.5H12z"/>
                    </svg>
                    Google
                </button>
            </form>
            <form method="post" asp-page-handler="ExternalLogin">
                <input type="hidden" name="provider" value="GitHub" />
                <input type="hidden" name="returnUrl" value="@returnUrl" />
                <button class="social-btn github" type="submit">
                    <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M12 .5a12 12 0 0 0-3.79 23.39c.6.11.82-.26.82-.58v-2.03c-3.34.73-4.04-1.61-4.04-1.61-.55-1.41-1.34-1.79-1.34-1.79-1.09-.75.08-.74.08-.74 1.2.08 1.83 1.26 1.83 1.26 1.08 1.86 2.82 1.32 3.5 1 .11-.79.42-1.32.76-1.63-2.67-.31-5.48-1.36-5.48-6.04 0-1.34.47-2.44 1.24-3.3-.12-.31-.54-1.56.12-3.24 0 0 1.01-.33 3.3 1.26A11.3 11.3 0 0 1 12 6.7c1.01.01 2.03.14 2.98.41 2.29-1.59 3.29-1.26 3.29-1.26.66 1.68.25 2.93.12 3.24.77.86 1.24 1.96 1.24 3.3 0 4.69-2.81 5.73-5.49 6.03.43.38.82 1.11.82 2.25v3.34c0 .32.22.69.83.57A12 12 0 0 0 12 .5z"/>
                    </svg>
                    GitHub
                </button>
            </form>
        </div>

        <div class="account-cta">
            <p class="account-copy">New to Bugence?<br>Create Account</p>
            <a class="signup-btn" href="/Auth/Register">Sign Up</a>
        </div>
    </main>

    <div class="fixed bottom-10 right-10 text-[9px] text-gray-600">
        <p>EVOLUTION_ENGINE: <span id="evoStatus" class="text-white">IDLE</span></p>
        <p>COMPLEXITY_INDEX: <span id="complexity" class="text-white">LOW</span></p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script>
    <partial name="_ValidationScriptsPartial" />

    <script>
        const cursor = document.getElementById('cursor');
        document.addEventListener('mousemove', (e) => {
            gsap.to(cursor, { x: e.clientX, y: e.clientY, duration: 0 });
        });

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        const geometry = new THREE.BufferGeometry();
        const count = 6000;
        const positions = new Float32Array(count * 3);
        const colors = new Float32Array(count * 3);
        for (let i = 0; i < count * 3; i++) {
            positions[i] = (Math.random() - 0.5) * 12;
            colors[i] = Math.random();
        }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
        const material = new THREE.PointsMaterial({ size: 0.025, vertexColors: true, transparent: true, opacity: 0.6 });
        const points = new THREE.Points(geometry, material);
        scene.add(points);
        camera.position.z = 6;

        const idField = document.getElementById('idField');
        const passField = document.getElementById('passField');
        const morphText = document.getElementById('morphText');
        const phaseText = document.getElementById('phaseText');

        function morphTo(state) {
            const pos = points.geometry.attributes.position.array;
            if (state === 'idle') {
                phaseText.innerText = "PHASE_01: SEEDING";
                document.getElementById('evoStatus').innerText = "IDLE";
                for (let i = 0; i < count; i++) {
                    gsap.to(pos, {
                        [i * 3]: (Math.random() - 0.5) * 12,
                        [i * 3 + 1]: (Math.random() - 0.5) * 12,
                        [i * 3 + 2]: (Math.random() - 0.5) * 12,
                        duration: 2,
                        onUpdate: () => points.geometry.attributes.position.needsUpdate = true
                    });
                }
            }
            if (state === 'blueprint') {
                phaseText.innerText = "PHASE_02: CONCEPTION";
                document.getElementById('evoStatus').innerText = "STABLE";
                for (let i = 0; i < count; i++) {
                    const phi = Math.acos(-1 + (2 * i) / count);
                    const theta = Math.sqrt(count * Math.PI) * phi;
                    gsap.to(pos, {
                        [i * 3]: 3 * Math.cos(theta) * Math.sin(phi),
                        [i * 3 + 1]: 3 * Math.sin(theta) * Math.sin(phi),
                        [i * 3 + 2]: 3 * Math.cos(phi),
                        duration: 1.5,
                        ease: "expo.out",
                        onUpdate: () => points.geometry.attributes.position.needsUpdate = true
                    });
                }
            }
            if (state === 'hyper') {
                phaseText.innerText = "PHASE_03: TRANSCENDENCE";
                document.getElementById('evoStatus').innerText = "EVOLVED";
                for (let i = 0; i < count; i++) {
                    const ratio = i / count;
                    const angle = ratio * Math.PI * 20;
                    gsap.to(pos, {
                        [i * 3]: Math.cos(angle) * (2 + Math.sin(angle * 0.5)),
                        [i * 3 + 1]: Math.sin(angle) * (2 + Math.cos(angle * 0.5)),
                        [i * 3 + 2]: Math.tan(ratio * Math.PI) * 0.5,
                        duration: 1,
                        ease: "back.out(1.7)",
                        onUpdate: () => points.geometry.attributes.position.needsUpdate = true
                    });
                }
            }
        }

        idField.addEventListener('input', (e) => {
            if (e.target.value.length > 0 && passField.value.length === 0) morphTo('blueprint');
            else if (e.target.value.length === 0) morphTo('idle');
        });

        passField.addEventListener('input', (e) => {
            if (e.target.value.length > 0) morphTo('hyper');
            else if (e.target.value.length === 0 && idField.value.length > 0) morphTo('blueprint');
        });

        function animate() {
            requestAnimationFrame(animate);
            points.rotation.y += 0.003;
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
