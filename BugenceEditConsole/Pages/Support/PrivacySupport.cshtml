@page
@model BugenceEditConsole.Pages.Support.PrivacySupportModel
@{
    ViewData["Title"] = "PrivacySupport";
    ViewData["BodyClass"] = "page-support-privacysupport";

    var userName = (User?.Identity?.IsAuthenticated == true && !string.IsNullOrWhiteSpace(User.Identity?.Name))
        ? User.Identity!.Name!
        : "Administrator";
    var userInitials = new string(userName
        .Split(' ', StringSplitOptions.RemoveEmptyEntries)
        .Where(part => !string.IsNullOrWhiteSpace(part))
        .Select(part => char.ToUpperInvariant(part[0]))
        .Take(2)
        .ToArray());
    if (string.IsNullOrWhiteSpace(userInitials))
    {
        userInitials = "AD";
    }
    var userEmail = User?.Claims?.FirstOrDefault(c => c.Type == System.Security.Claims.ClaimTypes.Email)?.Value;
    if (string.IsNullOrWhiteSpace(userEmail))
    {
        userEmail = "Bugence";
    }
}

@section Head {
<style>
        :root { --bg:#020202; --surface:#0a0a0a; --surface-hover:#121212; --border:rgba(255,255,255,0.08); --text:#e5e5e5; --muted:#737373; --accent:#06b6d4; --accent-dim:rgba(6,182,212,0.1); --success:#10b981; --warning:#f59e0b; --danger:#ef4444; }
        * { box-sizing:border-box; outline:none; }
        body { margin:0; background:var(--bg); color:var(--text); font-family:'Satoshi',sans-serif; display:flex; height:100vh; overflow:hidden; }
        .shell { display:flex; width:100%; height:100%; }
        aside { width:260px; flex-shrink:0; background:#050505; border-right:1px solid var(--border); padding:24px; display:flex; flex-direction:column; z-index:20; }
        main { flex-grow:1; padding:0; overflow-y:auto; background: radial-gradient(circle at 50% 0%, rgba(6,182,212,0.03), transparent 50%); position:relative; }
        .content-container { max-width:1100px; margin:0 auto; padding:60px 40px; }
        .brand { font-family:'Cabinet Grotesk',sans-serif; font-weight:800; font-size:1.2rem; color:white; text-decoration:none; margin-bottom:40px; display:flex; gap:10px; align-items:center; letter-spacing:-0.5px; }
        .menu-label { font-size:0.7rem; color:#444; font-weight:700; margin:20px 0 8px 12px; text-transform:uppercase; letter-spacing:1px; }
        .nav-item { padding:10px 14px; color:var(--muted); text-decoration:none; display:flex; gap:12px; align-items:center; font-weight:600; border-radius:10px; margin-bottom:4px; transition:0.2s; font-size:0.9rem; }
        .nav-item:hover { background:var(--surface-hover); color:white; }
        .nav-item.active { background:var(--surface-hover); color:white; border:1px solid var(--border); }
        .nav-icon { width:20px; text-align:center; }
        .profile-block { margin-top:auto; padding-top:20px; border-top:1px solid var(--border); position:relative; }
        .profile-card { display:flex; align-items:center; gap:10px; padding:10px 12px; background:rgba(255,255,255,0.03); border:1px solid var(--border); border-radius:12px; cursor:pointer; position:relative; }
        .profile-card .avatar { width:40px; height:40px; border-radius:12px; background:linear-gradient(135deg,#06b6d4,#22d3ee); display:grid; place-items:center; font-weight:800; color:#00131a; }
        .profile-menu { position:absolute; left:0; right:0; bottom:calc(100% + 8px); background:#0b0e14; border:1px solid var(--border); border-radius:12px; padding:8px 0; display:none; box-shadow:0 20px 40px rgba(0,0,0,0.45); }
        .profile-card.show .profile-menu { display:block; }
        .profile-menu a { display:block; padding:8px 12px; color:white; text-decoration:none; font-weight:600; }
        .profile-menu a:hover { background:rgba(255,255,255,0.05); }
        .header { margin-bottom:50px; display:flex; justify-content:space-between; align-items:end; }
        .header h1 { font-family:'Cabinet Grotesk',sans-serif; font-size:2.5rem; margin:0 0 10px; }
        .header p { color:var(--muted); margin:0; max-width:600px; line-height:1.5; font-size:1.1rem; }
        .support-grid { display:grid; grid-template-columns:2fr 1fr; gap:40px; }
        .card { background:var(--surface); border:1px solid var(--border); border-radius:20px; padding:30px; margin-bottom:30px; transition:0.2s; position:relative; overflow:hidden; }
        .card-title { font-size:1.2rem; font-weight:700; margin:0 0 20px; color:white; display:flex; align-items:center; gap:10px; }
        .card-desc { color:var(--muted); font-size:0.95rem; margin-bottom:25px; line-height:1.6; }
        .form-group { margin-bottom:20px; }
        .label { display:block; color:var(--muted); font-size:0.85rem; margin-bottom:8px; font-weight:600; }
        .input, .textarea, .select { width:100%; background:#111; border:1px solid var(--border); padding:14px; border-radius:10px; color:white; font-family:inherit; transition:0.2s; outline:none; font-size:0.95rem; }
        .input:focus, .textarea:focus, .select:focus { border-color:var(--accent); box-shadow:0 0 0 4px var(--accent-dim); }
        .textarea { resize:vertical; min-height:120px; }
        .btn-submit { background:var(--accent); color:black; border:none; padding:12px 24px; border-radius:10px; font-weight:800; cursor:pointer; transition:0.2s; display:inline-flex; align-items:center; gap:8px; }
        .btn-submit:hover { filter:brightness(1.1); transform:translateY(-2px); }
        .status-banner { margin-bottom:24px; padding:14px 16px; border-radius:14px; border:1px solid rgba(16,185,129,0.35); background:rgba(16,185,129,0.1); color:#a7f3d0; font-weight:700; }
        .status-banner.error { border-color:rgba(239,68,68,0.35); background:rgba(239,68,68,0.1); color:#fecaca; }
        .field-validation { margin-top:6px; color:#fca5a5; font-size:0.8rem; }
        .action-list { display:flex; flex-direction:column; gap:12px; }
        .action-btn { background:rgba(255,255,255,0.03); border:1px solid var(--border); padding:15px; border-radius:12px; color:#ddd; cursor:pointer; text-align:left; transition:0.2s; display:flex; align-items:center; gap:15px; }
        .action-btn:hover { background:rgba(255,255,255,0.06); color:white; border-color:#444; }
        .action-icon { width:32px; height:32px; background:#222; border-radius:8px; display:grid; place-items:center; font-size:1rem; color:var(--muted); }
        .btn-danger-zone { border-color:rgba(239,68,68,0.3); color:var(--danger); background:rgba(239,68,68,0.05); }
        .btn-danger-zone:hover { background:rgba(239,68,68,0.1); border-color:var(--danger); color:white; }
        .btn-danger-zone .action-icon { color:var(--danger); background:rgba(239,68,68,0.1); }
        .compliance-row { display:flex; gap:10px; margin-top:20px; }
        .comp-badge { display:flex; align-items:center; gap:8px; padding:8px 12px; border-radius:8px; background:#111; border:1px solid var(--border); font-size:0.8rem; font-weight:600; color:#aaa; }
        .comp-check { color:var(--success); }
        .faq-item { border-bottom:1px solid var(--border); }
        .faq-question { padding:18px 0; cursor:pointer; font-weight:600; display:flex; justify-content:space-between; align-items:center; transition:0.2s; }
        .faq-question:hover { color:var(--accent); }
        .faq-answer { max-height:0; overflow:hidden; transition:0.3s cubic-bezier(0.4, 0, 0.2, 1); color:var(--muted); font-size:0.95rem; line-height:1.6; }
        .faq-answer p { margin:0 0 18px 0; }
        .chevron { transition:0.3s; font-size:0.8rem; }
        .faq-item.active .faq-answer { max-height:200px; }
        .faq-item.active .chevron { transform:rotate(180deg); color:var(--accent); }
        .toast-container { position:fixed; bottom:30px; right:30px; z-index:1000; }
        .toast { background:#111; border:1px solid var(--border); color:white; padding:15px 20px; border-radius:10px; box-shadow:0 10px 30px rgba(0,0,0,0.5); display:flex; align-items:center; gap:12px; animation: slideUp 0.3s forwards; min-width:300px; }
        @@keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
}

<div class="content-container">
                @if (!string.IsNullOrWhiteSpace(Model.StatusMessage))
                {
                    <div class="status-banner @(string.Equals(Model.StatusKind, "error", StringComparison.OrdinalIgnoreCase) ? "error" : string.Empty)">
                        @Model.StatusMessage
                    </div>
                }
                <div class="header">
                    <div>
                        <h1>Privacy & Support Center</h1>
                        <p>Manage your data rights, submit privacy inquiries, or get help with your Bugence workspace.</p>
                    </div>
                    <div class="compliance-row">
                        <div class="comp-badge"><i class="fa-solid fa-check-circle comp-check"></i> SOC 2 Type II</div>
                        <div class="comp-badge"><i class="fa-solid fa-check-circle comp-check"></i> GDPR Ready</div>
                    </div>
                </div>
                <div class="support-grid">
                    <div class="left-col">
                        <div class="card">
                            <div class="card-title"><i class="fa-regular fa-paper-plane"></i> Submit a Request</div>
                            <p class="card-desc">Have a question about your data or need technical help? Our privacy team usually responds within 24 hours.</p>
                            <form method="post" asp-page-handler="Submit">
                                <input asp-for="Input.IntegrationKey" type="hidden" />
                                <input asp-for="Input.SourcePage" type="hidden" />
                                <div class="form-group">
                                    <label class="label" asp-for="Input.Category">Inquiry Type</label>
                                    <select class="select" asp-for="Input.Category">
                                        <option value="general_support">General Support</option>
                                        <option value="integration_setup">Integration Setup Request</option>
                                        <option value="data_export">Data Export Request (GDPR)</option>
                                        <option value="account_deletion">Account Deletion</option>
                                        <option value="security">Report a Vulnerability</option>
                                    </select>
                                    <span class="field-validation" asp-validation-for="Input.Category"></span>
                                </div>
                                @if (!string.IsNullOrWhiteSpace(Model.Input.IntegrationKey))
                                {
                                    <div class="form-group">
                                        <label class="label">Integration</label>
                                        <input type="text" class="input" value="@Model.IntegrationLabel" readonly />
                                    </div>
                                }
                                <div class="form-group">
                                    <label class="label" asp-for="Input.Subject">Subject</label>
                                    <input asp-for="Input.Subject" type="text" class="input" placeholder="Briefly describe the issue...">
                                    <span class="field-validation" asp-validation-for="Input.Subject"></span>
                                </div>
                                <div class="form-group">
                                    <label class="label" asp-for="Input.Message">Message</label>
                                    <textarea asp-for="Input.Message" class="textarea" placeholder="Provide details about your request..."></textarea>
                                    <span class="field-validation" asp-validation-for="Input.Message"></span>
                                </div>
                                <button class="btn-submit" id="submitBtn" type="submit">Send Request <i class="fa-solid fa-arrow-right"></i></button>
                            </form>
                        </div>
                        <div class="card">
                            <div class="card-title">Common Questions</div>
                            <div class="faq-item">
                                <div class="faq-question" onclick="toggleFaq(this)">Where is my data stored?<i class="fa-solid fa-chevron-down chevron"></i></div>
                                <div class="faq-answer"><p>Bugence data is encrypted and stored in secure AWS data centers located in the US-East (N. Virginia) region. We utilize multi-zone redundancy for high availability.</p></div>
                            </div>
                            <div class="faq-item">
                                <div class="faq-question" onclick="toggleFaq(this)">How do I export my project data?<i class="fa-solid fa-chevron-down chevron"></i></div>
                                <div class="faq-answer"><p>You can use the "Export Personal Data" tool on this page. It will generate a downloadable JSON archive containing your project configurations, logs, and account details.</p></div>
                            </div>
                            <div class="faq-item">
                                <div class="faq-question" onclick="toggleFaq(this)">Who has access to my code?<i class="fa-solid fa-chevron-down chevron"></i></div>
                                <div class="faq-answer"><p>Only you and your invited team members have access to your repositories. Bugence support staff do not access your source code unless explicitly authorized via a temporary support token.</p></div>
                            </div>
                        </div>
                    </div>
                    <div class="right-col">
                        <div class="card" style="padding:20px;">
                            <div class="card-title" style="font-size:1rem; margin-bottom:15px;">Self-Serve Data Tools</div>
                            <div class="action-list">
                                <div class="action-btn" id="exportDataBtn">
                                    <div class="action-icon"><i class="fa-solid fa-download"></i></div>
                                    <div><div style="font-weight:700; font-size:0.9rem;">Export Data</div><div style="font-size:0.75rem; color:var(--muted);">Download JSON archive</div></div>
                                </div>
                                <div class="action-btn" onclick="location.href='/Settings/GlobalSettings'">
                                    <div class="action-icon"><i class="fa-solid fa-cookie-bite"></i></div>
                                    <div><div style="font-weight:700; font-size:0.9rem;">Cookie Preferences</div><div style="font-size:0.75rem; color:var(--muted);">Manage tracking settings</div></div>
                                </div>
                                <a href="#" target="_blank" class="action-btn">
                                    <div class="action-icon"><i class="fa-solid fa-file-contract"></i></div>
                                    <div><div style="font-weight:700; font-size:0.9rem;">Legal Center</div><div style="font-size:0.75rem; color:var(--muted);">Terms & Privacy Policy</div></div>
                                </a>
                                <div class="action-btn btn-danger-zone" id="deleteAccountBtn">
                                    <div class="action-icon"><i class="fa-solid fa-trash"></i></div>
                                    <div><div style="font-weight:700; font-size:0.9rem;">Delete Account</div><div style="font-size:0.75rem; opacity:0.8;">Permanently erase all data</div></div>
                                </div>
                            </div>
                        </div>
                        <div class="card" style="background:linear-gradient(145deg, rgba(6,182,212,0.1), transparent); border-color:var(--accent-dim);">
                            <div class="card-title" style="font-size:1rem; color:var(--accent);">Priority Support</div>
                            <p style="font-size:0.85rem; color:var(--muted); margin-bottom:15px;">You are on the <b>Pro Plan</b>. You have access to 24/7 live chat support.</p>
                            <button style="width:100%; background:var(--surface); border:1px solid var(--accent); color:var(--accent); padding:10px; border-radius:8px; font-weight:700; cursor:pointer;">Start Live Chat</button>
                        </div>
                    </div>
                </div>
            </div>




